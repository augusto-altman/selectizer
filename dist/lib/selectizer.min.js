function ObjectSources(a,b){var c=require("path"),d=require("fs"),e=null,f={};return f.success=!1,f.data={},b=b||".",b=c.resolve(process.cwd(),b),a?d.existsSync(b+"/"+a)?d.existsSync(b+"/"+a+"/src")?d.existsSync(b+"/"+a+"/config")?(f.success=!0,f.data.object=a,f.data.objectFolder=b,f.data.config=e,f.data.paths={},f.data.paths.build=b+"/"+a+"/build/",f.data.paths.src=b+"/"+a+"/src/",f.data.paths.config=b+"/"+a+"/config/",e=require(f.data.paths.config+f.data.object+".config.json"),f.data.config=e||{},f.data.config.name=e.name||"",f.data.config.modules=e.modules||[],f.data.config.paths=e.paths||[],f.data.config.wrap=e.wrap||{}):(f.data.errorMsg="Error: The path "+b+"/"+a+"/config doesn't exist",f.data.errorCode=4):(f.data.errorMsg="Error: The path "+b+"/"+a+"/src doesn't exist",f.data.errorCode=3):(f.data.errorMsg="Error: The path "+b+"/"+a+" doesn't exist",f.data.errorCode=2):(f.data.errorMsg="Error: Generation requires an object name.",f.data.errorCode=1),f}function GenerationHandler(a,b,c){function d(){var a="require([",b=0,c=null;for(var d in e.data.config.modules)a+=0===b?'"'+e.data.config.modules[d]+'"':', "'+e.data.config.modules[d]+'"',b++;return a+="], function() {\n",c=f.readFileSync(e.data.paths.config+e.data.object+".initCode.js","utf8"),a+=c+"\n});",f.writeFileSync(e.data.paths.build+e.data.object+"-init.js",a)}var e=Object.create(ObjectSources(a,b)),f=require("fs"),g=require("mkdirp"),h=require("requirejs");e.success&&(e.data.requireJSOptions={baseUrl:e.data.paths.src,name:"../build/"+e.data.object+"-init",out:e.data.paths.build+e.data.object+".js",optimize:"none",useStrict:!0,paths:e.data.config.paths,wrap:e.data.config.wrap,onBuildWrite:function(a,b,c){return/define\(.*?\{/.test(c)?(c=c.replace(/define\(.*?\{/,""),c=c.replace(/\}\);\s*?$/,""),c=c.replace(/return.*[^return]*$/,"")):/require\([^\{]*?\{/.test(c)&&(c=c.replace(/require[^\{]+\{/,""),c=c.replace(/\}\);\s*$/,"")),c}},e.generate=function(){g(this.data.paths.build,function(a){a?c({success:!1,data:{errorMsg:a,errorCode:0}}):(d(),h.optimize(this.data.requireJSOptions,function(){var a=f.readFileSync(this.data.requireJSOptions.out,"utf8");a=a.replace('define("../build/'+this.data.object+'-init", function(){});',""),a=a.replace('define("'+this.data.object+'", function(){});',""),a=a.replace(/\s*?\n\s*?;\n/g,"\n"),f.writeFileSync(this.data.requireJSOptions.out,a,"utf8"),f.unlinkSync(this.data.paths.build+this.data.object+"-init.js")}.bind(this),function(a){f.unlinkSync(this.data.paths.build+this.data.object+"-init.js"),c({success:!1,data:{errorMsg:a,errorCode:0}})}))}.bind(this))}),c(e)}module.exports=GenerationHandler;